{% load static %}

<header id="header" class="header d-flex align-items-center sticky-top">
  <div
    class="container-fluid container-xl position-relative d-flex align-items-center"
  >
    <a
      href="{% url 'core:home' %}"
      class="logo d-flex align-items-center me-auto"
    >
      <!-- Logo -->
      <img src="{% static 'assets/img/logo.png' %}" alt="Logo Image" />
      <h1 class="sitename">Skill Swap</h1>
    </a>

    <nav id="navmenu" class="navmenu">
      <ul>
        <li><a href="{% url 'core:home' %}" class="{% if request.resolver_match.url_name == 'home' %} active {% endif %}">Home</a></li>
        <li><a href="{% url 'category_skills:courses' %}" class="{% if request.resolver_match.url_name == 'courses' %} active {% endif %}">Courses</a></li>
        <li><a href="{% url 'category_skills:instructors' %}" class="{% if request.resolver_match.url_name == 'instructors' %} active {% endif %}">Instructors</a></li>
        <li><a href="{% url 'university:university' %}" class="{% if request.resolver_match.url_name == 'university' %} active {% endif %}">University</a></li>
        <li><a href="{% url 'blog:blogs' %}" class="{% if request.resolver_match.url_name == 'blogs' %} active {% endif %}">Blogs</a></li>
        <li><a href="{% url 'core:contact' %}" class="{% if request.resolver_match.url_name == 'contact' %} active {% endif %}">Contact</a></li>
        <li><a href="{% url 'core:about' %}" class="{% if request.resolver_match.url_name == 'about' %} active {% endif %}">About</a></li>
        
        <!-- Theme Toggle (Always Visible) -->
        <li class="ms-2">
          <a class="nav-link theme-toggle me-3" id="theme-toggle" title="Toggle theme" href="#">
            <i class="bi bi-moon-stars-fill fs-4"></i>
            <i class="bi bi-sun-fill fs-4 d-none"></i>
          </a>
        </li>

        {% if custom_user %}
        <!-- Notifications -->
        <li class="ms-3">
          <div class="position-relative">
            <a href="#" class="text-decoration-none" id="notificationBell" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="bi bi-bell fs-5"></i>
              <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" id="notificationCount" style="display: none;">
                0
              </span>
            </a>
            <div class="dropdown-menu dropdown-menu-end notification-dropdown" aria-labelledby="notificationBell" style="width: 350px; max-height: 400px; overflow-y: auto;">
              <div class="dropdown-header d-flex justify-content-between align-items-center">
                <h6 class="mb-0">Notifications</h6>
                <button class="btn btn-sm btn-outline-primary" onclick="markAllAsRead()">Mark All Read</button>
              </div>
              <div class="dropdown-divider"></div>
              <div id="notificationsList">
                <div class="text-center text-muted py-3">
                  <i class="bi bi-bell-slash fs-3"></i>
                  <p class="mb-0">No notifications</p>
                </div>
              </div>
            </div>
          </div>
        </li>
        {% endif %}
      </ul>
      <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
    </nav>

    {% if custom_user %}
    <!-- User Dropdown -->
    <div class="dropdown ms-3">
      <a class="d-flex align-items-center text-decoration-none dropdown-toggle"
         href="#"
         id="userDropdown"
         role="button"
         data-bs-toggle="dropdown"
         aria-expanded="false">

        {% if custom_user.profile_pic %}
          <img src="{{ custom_user.profile_pic.url }}" alt="Profile Picture"
               class="rounded-circle me-2"
               style="width: 40px; height: 40px; object-fit: cover;" />
        {% else %}
          <img src="{% static 'assets/img/default-avatar.webp' %}" alt="Default Avatar"
               class="rounded-circle me-2"
               style="width: 40px; height: 40px; object-fit: cover;" />
        {% endif %}

        <span class="fw-semibold text-dark">{{ custom_user.username }}</span>
      </a>

      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
        <li><a class="dropdown-item" href="{% url 'accounts:dashboard' %}"><i class="bi bi-speedometer2 me-2"></i>Dashboard</a></li>
        <li><a class="dropdown-item" href="{% url 'accounts:profile' %}"><i class="bi bi-person me-2"></i>My Profile</a></li>
        <li><hr class="dropdown-divider"></li>
        <li><a class="dropdown-item" href="{% url 'category_skills:requests' %}"><i class="bi bi-send me-2"></i>My Requests</a></li>
        <li><a class="dropdown-item" href="{% url 'category_skills:sessions' %}"><i class="bi bi-calendar-check me-2"></i>My Sessions</a></li>
        <li><hr class="dropdown-divider"></li>
        <li><a class="dropdown-item" href="{% url 'blog:blog-profile-view' %}"><i class="bi bi-pencil-square me-2"></i>My Blogs</a></li>
        <li><hr class="dropdown-divider"></li>
        <li><a class="dropdown-item text-danger" href="{% url 'accounts:logout' %}"><i class="bi bi-box-arrow-right me-2"></i>Logout</a></li>
      </ul>
    </div>
    {% else %}
      <a class="btn-getstarted" data-bs-toggle="modal" data-bs-target="#openloginModal" href="">Login</a>
    {% endif %}
  </div>
</header>

<!-- Login Modal -->
<div class="modal fade" id="openloginModal" tabindex="-1" aria-labelledby="openloginModalLabel" aria-hidden="true" >
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-body">
        {% include "accounts/login.html" %}
      </div>
    </div>
  </div>
</div>

<!-- Register Modal -->
<div class="modal fade" id="openregisterModal" tabindex="-1" aria-labelledby="openregisterModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-body">
            {% include "accounts/register.html" %}
        </div>
      </div>
    </div>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
<script src="{% static 'assets/js/accounts/login.js' %}"></script>
<script src="//cdn.ckeditor.com/4.21.0/standard/ckeditor.js"></script>
<script src="{% static 'assets/js/accounts/notifications.js' %}"></script>
<script src="{% static 'assets/js/accounts/register.js' %}"></script>
<script src="{% static 'assets/js/core/head.js' %}"></script>
<script src="{% static 'assets/js/core/header.js' %}"></script>



